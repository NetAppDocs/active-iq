---
sidebar: sidebar
permalink: reference_SE_FAQ.html
keywords: Active IQ, storage efficiency, FAQs, storage efficiency
summary: Provides FAQs on storage efficiency.
---

= FAQs
:hardbreaks:
:nofooter:
:icons: font
:linkattrs:
:imagesdir: ./media/

== How do I access the storage efficiency in Active IQ?

.Step
. Open home page of link:https://activeiq.netapp.com[Active IQ].
. Search for a Customer/Site/Group/Cluster/Node from the top right search box to reach the respective dashboard.
. Click *Storage Efficiency* from the left navigation.

== Does Active IQ display ratios for all ONTAP systems?

Active IQ displays ratios for systems running ONTAP 9.1 and later.

== What is the ‘Without Snapshots’ checkbox in the efficiency dashboard?

By default, *Active IQ Efficiency Dashboard* calculates overall ratio at customer-level, site-level, group-level, cluster-level, and node-level. Overall ratio includes the ratio from the following storage efficiency technologies:

	* Deduplication
	* Compression
	* Data compaction
	* Clones and
	* Snapshots

By selecting *Without Snapshots* checkbox, Active IQ will calculate efficiency ratio (ratio from deduplication, compression, data compaction and clones storage efficiency technologies) at customer-level, site-level, group-level, cluster-level and node-level.

This option is provided to support customers who have signed up for NetApp storage guarantee program that guarantees x:1 data reduction ratio based on customer-workload. Customers can use Active IQ Storage Efficiency dashboard to monitor data reduction ratios during the guarantee period.

To know more about NetApp Storage Guarantee program, refer link:https://www.netapp.com/us/media/netapp-aff-efficiency-guarantee.pdf[All-Flash Guarantee].

== What is physical data used and logical data used?

* *Physical Blocks Consumed / Physical Data Used*
** The amount of space being used for data now (rather than being reserved for future use).
** Includes space used by aggregate Snapshot copies.
** Space actually consumed/written by the client

* *Total Logical Data Used*
** Displays the logical size used in the aggregate.
** This includes Volumes, Clones and Snapshots in the aggregate.
** The logical size is computed based on physical usage (real writes) and savings obtained in the aggregate.
** Does not include space reserved for future use.

== How are aggregate-level, node-level and cluster-level ratios calculated? My customer’s systems are behind a secure DMZ/CMZ and cannot send AutoSupport to NetApp. How do I calculate the ratios for those systems?

This is how we calculate different ratios. You can follow these steps to calculate the ratios manually

=== Aggregate-level ratios

==== Aggregate Overall Ratio

Overall ratio at aggregate-level are directly obtained from ONTAP using ZAPI. They can also be obtained from aggr-efficiency.xml section in AutoSupport.

For systems that do not have access to AutoSupport, ‘aggregate show-efficiency …’ CLI commands can be used.

==== Aggregate Data Reduction Ratio

The formula to calculate aggregate-level data reduction ratio is as follows:

image:calculate_formula.jpeg[image,width=530,height=31]

=== Node-level and Cluster-level ratios

==== Node/Cluster Overall Ratio

Active IQ uses data from aggr-efficiency.xml output to calculate node/cluster- level overall ratio.

For systems that do not have access to AutoSupport, you can use data from ‘aggregate show-efficiency –advanced’ to calculate node/cluster-level overall ratio.

Follow the steps below to calculate Node/Cluster overall ratio:

.Step
. Sum ‘Total/Cumulative Logical Used’ and ‘Total/Cumulative Physical Used’ for all the aggregates in the node/cluster to get ‘Node/Cluster Logical Used’ and ‘Node/Cluster Physical Used’ respectively.
. Divide ‘Node/Cluster Logical Used’ by ‘Node/Cluster Physical Used’ to get node/cluster data reduction ratio.

==== Node/Cluster Data Reduction Ratio

Active IQ uses the following steps to calculate node/cluster-level overall ratio.

.Step
. Calculate ‘Data Reduction Logical Used’ and ‘Data Reduction Physical Used’ for all the aggregates in the node/cluster using the formula mentioned in Aggregate Data Reduction Ratio.
. Sum ‘Data Reduction Logical Used’ and ‘Data Reduction Physical Used’ for all the aggregates in the node/cluster to get ‘Node/Cluster Data Reduction Logical Used’ and ‘Node/Cluster Data Reduction Physical Used’ respectively.
. Divide ‘Node/Cluster Data Reduction Logical Used’ by ‘Node/Cluster Data Reduction Physical Used’ to get node/cluster data reduction ratio.

== Which sections of AutoSupport are used for determining the efficiency ratios and how do I view the section?

Active IQ uses aggr-efficiency.xml section in AutoSupport for ONTAP 9.x. This section contains efficiency and capacity information of all aggregates of the cluster.

These AutoSupport sections are viewable from the AutoSupport tab in left navigation of cluster dashboard of link:https://activeiq.netapp.com[Active IQ]. Remember to view a weekly or a user triggered AutoSupport.

== Which AutoSupports are used for calculating efficiency ratios?

Calculations are performed using either the latest weekly or user-triggered AutoSupports which tend to contain most of the sections required for calculating the ratios.

== Which volumes or aggregates are excluded from efficiency calculations?

The following objects are not considered while calculating efficiency ratios:

* Root aggregates
* Offline volumes
* Vserver root/admin root volumes
* MCC configuration volumes

== How can I see the trend in efficiency ratios?

Currently, efficiency ratios are based on the latest weekly or user-triggered AutoSupport. Efficiency trending may be considered for a future release.

== How are customer-level ratios and efficiency savings calculated?

Customer level storage efficiency dashboard provides the efficiency ratio with and without Snapshot copies for AFF and non-AFF systems and are combined across the customer install base for *systems running ONTAP 9.1 and later*. The required parameters, for the following calculations, are taken from ONTAP AutoSupport:

=== Without Snapshot copies (calculated for per Aggr first):
* *Aggr Logical Used without Snapshot copies = Logical Size Used by Volumes, Clones, Snapshot Copies in the Aggregate – Logical Size Used by Snapshot Copies*
* *Aggr Physical Used Without Snapshot copies = Total Physical Used – (Physical Size Used by Snapshot copies / Aggregate Data Reduction SE Ratio)*
* *Customer Efficiency Ratio without Snapshot copies = Sum [Aggr Logical Used without Snapshot copies for all aggregates and for all nodes of a customer] / Sum [Aggr Physical Used without Snapshot copies for all aggregates and for all nodes of a customer] : 1*

=== With Snapshot copies:
*	*Customer Logical Size with Snapshot copies* = Sum *[Logical Size Used by Volumes, Clones, Snapshot copies for all aggregates and for all nodes of a customer]*
*	*Customer Physical Size Used with Snapshot copies* = Sum *[Total Physical Size Used for all aggregates and for all nodes of a customer]*
*	*Customer Efficiency Ratio with Snapshot copies = Customer Logical Size with Snapshot copies and Clones / Customer Physical Size Used with Snapshot copies and Clones : 1*

=== Efficiency feature table calculations:

*	*Total Physical Space Used:*
**	*Customer Physical Space Used = Sum of Physical Space Used by the Aggregate* for all aggregates and of all nodes of a customer.
*	*Total Logical Used:*
**	*Customer Logical Size Used without Snapshot copies = Sum of Logical Size Used by Volumes, Clones, Snapshot Copies - Logical Size Used by Snapshot copies* for all aggregates of all nodes of a customer
**	*Customer Logical Size Used with Snapshot copies = Sum of Logical Size Used by Volumes, Clones, Snapshot Copies in the Aggregate* for all aggregates of all nodes of a customer
*	*Total Space Saved = Total Logical Space Used – Total Physical Space Used*
*	*Deduplication Savings*: Sum of *Space Saved by Volume Deduplication + Space Saved by Inline Zero Pattern Detection* of each aggregate of all nodes of a customer.
*	*Compression Savings*: Sum of *Space Saved by Volume Compression* of each aggregate of all nodes of a customer.
*	*Compaction Savings (for ONTAP 	9.1)*: Sum of *Space Saved by Aggregate Compaction* of each aggregate of all nodes of a customer.
*	*Compaction Savings (for ONTAP 	9.2 and later)*: Sum of *Space Saved by Aggregate Data Reduction* of each aggregate of all nodes of a customer.
*	*FlexClone Savings*: Sum of *(Logical Size Used by FlexClone Volumes - Physical Sized Used by FlexClone Volumes)* of all aggregates of all nodes of a customer.
*	*Snapshot copies Backup Savings*: Sum of *(Logical Size Used by Snapshot copies - Physical Size Used by Snapshot copies)* of all aggregates of all nodes of a customer.

== Why adding all individual efficiency savings does not add up to total data saved by storage efficiency?

Efficiency savings are shown in the *Storage Efficiency Dashboard* for volumes and local tiers (aggregates).  You cannot linearly add volume savings and aggregate savings as they both happen at different storage objects.

== Is the efficiency ratio shown in Active IQ same as AFF Efficiency Guarantee Ratio?

Efficiency Ratio in Active IQ is same as AFF Efficiency Guarantee Ratio unless data compression and deduplication have been performed on the data, the data is encrypted, or the data contains raw images and video files. Please contact NetApp Sales for validating guarantee ratio. To know more about NetApp Storage Guarantee program, see link:https://www.netapp.com/us/media/netapp-aff-efficiency-guarantee.pdf[All-Flash Guarantee].

== Why storage efficiencies were reported incorrectly or higher before upgrading to ONTAP?

Storage efficiency is shown higher when data protection volumes are present in the node due to a bug in ONTAP. The issue is fixed in ONTAP 9.3P11. Storage efficiency can report correct or lower values when upgraded from ONTAP versions earlier than 9.3P11 and when data protection volumes are present in the node.

== How do I provide feedback or ask other questions related to storage efficiency?

For feedback or questions, send an email to mailto:ng-activeiq-feedback@netapp.com[[.underline]#ng-activeiq-feedback@netapp.com#]
